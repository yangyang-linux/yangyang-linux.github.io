---
layout:     post
title:      Docker
subtitle:   Docker学习
date:       2021-7-12
author:     YY——阳阳
header-img: img/post/1.jpg
catalog: true
tags:
    - Docker
---



## Docker

>  docker学习
>
>  - DOCKER概述;
>
>  - DOCKER安装
>
>  - DOCKER命令
>
>    - 镜像命令
>
>    - 容器命令
>
>    - 操作命令
>
>    - 。。。
>
>
>
>  - Docker镜像
>  - 容器的数据卷
>   - DockerFile
>   - Docker⽹络原理
>   - IDEA整合DOCKER
>   - Docker Compose
>   - Docker Swarm
>   - CI\CD jenkins

## Docker概述

#### Docker为什么会出现？

⼀款产品，开发-----上线，两套环境！应⽤环境！应⽤配置！

开发-------运维。 问题：我在我的电脑上可以使⽤！版本更新，导致服务不可⽤！对于运维来说考验⼗分⼤！

开发即运维！！！

环境配置⼗分麻烦，每⼀个机器都要配置环境（集群Redis、ES、Hadoop。。。）！！费时费⼒！！

发布⼀个项⽬jar+(REdis Mysql jdk ES)，项⽬带上环境安装打包！！

之前在服务器配置⼀个应⽤的环境（REdis Mysql jdk ES Hadoop）,配置超麻烦，不能够跨平台！！

windows，连最后发布到linux

传统：开发jar打包， 运维来做

现在：开发打包部署上线，⼀套流程做完

*java------apk-----发布(应⽤商店)----张三使⽤apk--------安装即可⽤*

*java------jar(环境)-------打包项⽬带环境(镜像！)--------Docker仓库：商店-----------下载我么发布的镜像直接运⾏即可*



**Docker对于以上问题产⽣了⼀个解决⽅案**

![image-20210712171654650](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712171654650.png)

docker思想来⾃⼀个集装箱

JRE ----多个应⽤（端⼝冲突）--------因为原来都是交叉的

隔离：Docker核⼼思想！打包装箱！每个箱⼦都是互相隔离的

**⽔果 -----⽣化武器**

Docker通过隔离机制，可以将服务器利⽤到极致

本质：所有的技术都是因为出现⼀些问题才会出现的；

#### Docker历史

2010 ，⼏个搞IT的年轻⼈，在美国成⽴了⼀家公司`dotcloud`,做⼀些pass的云计算服务,LXC(linux虚拟机)有关的容器技术

他们将⾃⼰的**容器化技术**命名就是Docker！

刚诞⽣的时候，没有引起⾏业的注意！！dotcloub，就活不下去！！

开源

2013年，Docker开源；

Docker越来越多的⼈发现了Docker的优点，每个⽉都会更新

2014年4⽉9⽇，Docker1.0发布

Docker这么⽕的原因？它相对虚拟机⼗分轻巧

在容器技术出现之前，我们都是使⽤虚拟机

虚拟机运⾏：在windows或者mac中安装⼀个虚拟机软件vmware，可以虚拟⼀台或多台电脑！占⽤内

存太⼤！笨重！

虚拟机也是属于虚拟化技术，Docker容器技术，也是⼀种虚拟化技术！

```shell
vm:linux centos(原⽣镜像)，隔离，就需要开启多个虚拟机 ！⼏个G 启动需要⼏分钟
Docker:隔离，镜像(最核⼼的环境 4m+jdk+mysql)⼗分的⼩巧，运⾏镜像就可以了！⼩巧！⼏M 、KB 秒级启动
```

到现在所有开发⼈员必须会

> 聊聊Docker

Docker是基于GO语⾔开发的 ！开源项⽬

官⽹：[https://www.docker.com](https://www.docker.com)

![image-20210712172619964](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712172619964.png)

⽂档地址：https://docs.docker.com Docker的⽂档超级详细的！

仓库地址：https://registry.hub.docker.com

#### Docker能干嘛？

>  之前的虚拟机技术

![image-20210712172740157](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712172740157.png)

**虚拟机技术的缺点：**

1.  占⽤资源⼗分多

2. 冗余步骤⼗分多

3. 启动很慢

---

> 容器化技术

**容器化技术不是模拟的完整的操作系统**

![image-20210712172853472](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712172853472.png)

**⽐较Docker和虚拟机技术的不同：**

- 传统虚拟机，虚拟出⼀个硬件 ，运⾏⼀个完整的操作系统，然后在这个系统上安装和运⾏软件
- 容器的应⽤直接运⾏在宿主机的内容，容器是没有⾃⼰的内核，也没有虚拟我们的硬件，所以就轻便了
- 每个容器件恶事互相隔离的，每个容器内都有⼀个属于⾃⼰的⽂件系统

---

> DebOps(开发，运维)

**更快速的交付和部署**

传统：⼀堆的帮助⽂档，安装程序

Docker：打包镜像，发布测试，⼀键运⾏

**更便捷的升级和扩缩容**

使⽤Docker之后，我们部署应⽤就和搭积⽊⼀样

项⽬打包为⼀个镜像，扩展 服务器A! 服务器B

**更简单的系统运维**

在容器化之后，我们的开发或测试环境,都是⾼度⼀致的

**更⾼效的计算机资源利⽤**

Docker 是内核级别的虚拟化 ，可以在物理机上运⾏很多的容器实例！服务器的性能可以被压榨到极致

## Docker安装

#### Docker基本组成

![image-20210712173500883](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712173500883.png)

**镜像(image)：**

docker镜像就好⽐是⼀个模版，可以通过这个模版来创建⼀个容器服务，tomcat===>run(运⾏起

来)===>tomcat01容器(提供服务)，通过这个镜像可以创建多个容器(最终服务器运⾏，或者项⽬运⾏

就是在容器中的)

**容器（container）：**

Docker利⽤容器技术，独⽴运⾏⼀个或者⼀组应⽤，通过镜像创建的

启动，停⽌，删除，基本命令！

⽬前就可以把容器理解为简易的linux系统

**仓库（repository）：**

存放镜像的地⽅！

仓库分为公有仓库和私有仓库：

Docker Hub（默认是国外的）

阿⾥云。。。。都有容器服务（配置镜像加速）

#### 安装Docker

> 环境准备

1. 需要会⼀点点linux基础

2. Centos

3. 使⽤xshell连接远程服务器操作

> 环境查看

```bash
# 系统内核是3.10以上的
[root@localhost ~]# uname -r
4.18.0-240.el8.x86_64
[root@localhost ~]# uname -r
4.18.0-240.el8.x86_64
# 系统版本
[root@localhost ~]# cat /etc/os-release
NAME="CentOS Linux"
VERSION="8"
ID="centos"
ID_LIKE="rhel fedora"
VERSION_ID="8"
PLATFORM_ID="platform:el8"
PRETTY_NAME="CentOS Linux 8"
ANSI_COLOR="0;31"
CPE_NAME="cpe:/o:centos:centos:8"
HOME_URL="https://centos.org/"
BUG_REPORT_URL="https://bugs.centos.org/"
CENTOS_MANTISBT_PROJECT="CentOS-8"
CENTOS_MANTISBT_PROJECT_VERSION="8"
```

> 安装

帮助⽂档：

```shell
# 1.卸载旧的版本
sudo yum remove docker \
 docker-client \
 docker-client-latest \
 docker-common \
 docker-latest \
 docker-latest-logrotate \
 docker-logrotate \
 docker-engine
# 2.需要的安装包
yum install -y yum-utils
# 3.设置镜像的仓库
yum-config-manager \
 --add-repo \
 https://download.docker.com/linux/centos/docker-ce.repo #默认是从国外的！
 
yum-config-manager \
 --add-repo \
 http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo #推荐使⽤阿⾥
云
 
# 更新yum软件包索引：
[root@localhost ~]# yum makecache 
# 4.安装Docker相关的内容 docker-ce 社区 ee 企业版
yum install docker-ce docker-ce-cli containerd.io
# 5.启动Docker
systemctl start docker
# 6.使⽤docker version查看是否安装成功
```

![image-20210712191827122](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712191827122.png)

```shell
# 7.使⽤hello world
docker run hello-world
```

![image-20210712192155254](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712192155254.png)

```shell
# 8.查看下载的hello-world镜像
[root@localhost ~]# docker images
REPOSITORY TAG IMAGE ID CREATED SIZE
hello-world latest d1165f221234 4 weeks ago 13.3kB
```

了解：卸载docker

```shell
# 1.卸载依赖
yum remove docker-ce docker-ce-cli containerd.io
# 2.删除资源
rm -rf /var/lib/docker
rm -rf /var/lib/containerd
# /var/lib/docker docker的默认⼯作路径
```

#### 阿里云镜像加速

1. 登陆阿⾥云找到容器服务
2. 找到镜像加速地址

![image-20210712192946448](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712192946448.png)

3. 配置使⽤

```shell
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://s82h6lek.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
```

#### 回顾helloworld

![image-20210712192155254](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712192155254.png)

![image-20210712193406226](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712193406226.png)

#### 底层原理

**Docker是怎么工作的？**

Docker是⼀个Client-Server结构的系统，Docker的守护进程运⾏在主机上，通过Socket从客户端访问！

Docker-server接收到Docker-Client的指令，就会执⾏！

![image-20210712193654803](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712193654803.png)

---

**Docker为什么⽐vm快？**

1. Docker有着⽐虚拟机更少的⽹络进程

2. Docker利⽤的是宿主机的内核，vm需要的是GuestOS；

![image-20210712193741064](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712193741064.png)

所以说，新建⼀个容器的时候，docker不需要像虚拟机⼀样重新加载⼀个操作系统内核，避免引导

型操作，虚拟机加载GuestOS，分钟级别的 ，Docker是利⽤宿主机的操作系统，省略了复杂的过

程，秒级！

![image-20210712201902495](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712201902495.png)

![image-20210712201939952](C:/Users/29854/AppData/Roaming/Typora/typora-user-images/image-20210712201939952.png)

## Docker常用命令

#### 帮助命令

```shell
docker version # 显示docker的版本信息
docker info # 显示docker的系统信息，包括镜像和容器的数量
docker 命令 --help # 万能命令帮助
```

