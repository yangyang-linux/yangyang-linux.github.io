---
layout:     post
title:      dvwa之File Inclusion
subtitle:   dvwa的文件包含
date:       2020-11-17
author:     YY——阳阳
header-img: img/post/post-bg-2020-11-17.jpg
catalog: true
tags:
    - dvwa
    - 文件包含
---

## 前言
File Inclusion，意思是文件包含（漏洞），是指当服务器开启allow_url_include选项时，就可以通过php的某些特性函数（include()，require()和include_once()，require_once()）利用url去动态包含文件，此时如果没有对文件来源进行严格审查，就会导致任意文件读取或者任意命令执行。文件包含漏洞分为本地文件包含漏洞与远程文件包含漏洞，远程文件包含漏洞是因为开启了php配置中的allow_url_fopen选项（选项开启之后，服务器允许包含一个远程的文件）。
## Low
#### 源码
```php
<?php

// The page we wish to display
$file = $_GET[ 'page' ];

?>
```
> 服务器对page参数没有做任何过滤检查


![](http://image.3001.net/images/20161106/14784220488447.png)
> 服务器期望用户的操作是点击上面的三个链接，服务器会包含相应的文件，并将结果返回。需要特别说明的是，服务器包含文件时，不管文件后缀是否是php，都会尝试当做php文件执行，如果文件内容为php，则会正常执行并返回结果；如果不是，则会原封不动地打印文件内容，所以文件包含漏洞常常会导致任意文件读取与任意命令执行。

#### 漏洞利用

###### 0x01